<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executive Estimator | I.S. 10101 Ready</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icon Components (Inline for standalone HTML) ---
        const IconActivity = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
        );
        const IconRuler = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z"/><path d="m14.5 12.5 2-2"/><path d="m11.5 9.5 2-2"/><path d="m8.5 6.5 2-2"/><path d="m17.5 15.5 2-2"/></svg>
        );
        const IconThermometer = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/><path d="M20 30V10"/><path d="M20 10V30"/></svg> // Simplified snowflake/thermometer representation
        ); 
        const IconCheckCircle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>
        );
        const IconAlertTriangle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        );
        const IconInfo = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        );
        const IconFileText = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
        );

        // --- Main App Component ---
        const App = () => {
            const [load, setLoad] = useState('');
            const [length, setLength] = useState('');
            const [phase, setPhase] = useState('1'); 
            const [cableType, setCableType] = useState('Twin & Earth');
            const [method, setMethod] = useState('clipped'); 
            const [results, setResults] = useState(null);

            // Inject the JotForm Agent Script on mount
            useEffect(() => {
                const script = document.createElement('script');
                script.src = "https://cdn.jotfor.ms/agent/embedjs/019600e0ca937f919845b00e1a153ee94e2a/embed.js";
                script.async = true;
                document.body.appendChild(script);

                return () => {
                    if (document.body.contains(script)) {
                        document.body.removeChild(script);
                    }
                };
            }, []);

            // Data based on I.S. 10101 / ET101 typical values for PVC Copper
            const cableData = [
                { size: 1.0, ratingC: 16, ratingA: 11.5, mvAm: 44 },
                { size: 1.5, ratingC: 20, ratingA: 14.5, mvAm: 29 },
                { size: 2.5, ratingC: 27, ratingA: 20, mvAm: 18 },
                { size: 4.0, ratingC: 37, ratingA: 26, mvAm: 11 },
                { size: 6.0, ratingC: 47, ratingA: 34, mvAm: 7.3 },
                { size: 10.0, ratingC: 64, ratingA: 46, mvAm: 4.4 },
                { size: 16.0, ratingC: 85, ratingA: 61, mvAm: 2.8 }
            ];

            useEffect(() => {
                if (!load || !length) {
                    setResults(null);
                    return;
                }

                const amps = parseFloat(load);
                const dist = parseFloat(length);
                const voltage = phase === '1' ? 230 : 400;

                const recommended = cableData.find(c => {
                    const rating = method === 'clipped' ? c.ratingC : c.ratingA;
                    return rating >= amps;
                });

                if (!recommended) {
                    setResults({ status: 'error', message: 'Load too high for standard domestic cables (<16mm²)' });
                    return;
                }
                
                const vDrop = (recommended.mvAm * amps * dist) / 1000;
                const vPercent = (vDrop / voltage) * 100;

                let status = 'success';
                let message = 'Compliant with I.S. 10101';

                if (vPercent > 5) {
                    status = 'fail';
                    message = 'Failed: Voltage drop > 5% (I.S. 10101 Limit)';
                } else if (vPercent > 3) {
                    status = 'warning';
                    message = 'Caution: Valid for Power (5%), too high for Lighting (>3%)';
                }

                setResults({
                    size: recommended.size,
                    rating: method === 'clipped' ? recommended.ratingC : recommended.ratingA,
                    amps: amps.toFixed(1),
                    drop: vDrop.toFixed(2),
                    percent: vPercent.toFixed(1),
                    status: status,
                    message: message
                });
            }, [load, length, phase, cableType, method]);

            return (
                <div className="min-h-screen bg-gray-900 text-white font-sans p-4 md:p-8">
                    {/* Header */}
                    <div className="max-w-2xl mx-auto mb-8 flex flex-col md:flex-row items-center justify-between gap-4">
                        <div className="flex items-center gap-4">
                            <img 
                                src="https://raw.githubusercontent.com/ohmydaysOMD/executiveelectrical.github.io/refs/heads/main/ee.png" 
                                alt="Executive Electrical Logo" 
                                className="w-16 h-16 object-contain drop-shadow-[0_0_10px_rgba(250,204,21,0.5)]"
                            />
                            <div>
                                <h1 className="text-3xl font-black text-yellow-400">
                                    Executive Estimator
                                </h1>
                                <p className="text-gray-400 text-sm">Calibrated to I.S. 10101:2020 Standards</p>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-2xl mx-auto grid gap-6">
                        {/* Calculator Card */}
                        <div className="bg-gray-800 rounded-3xl p-6 shadow-2xl border border-gray-700">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                {/* Load Input */}
                                <div className="space-y-2">
                                    <label className="text-sm font-semibold text-gray-400 flex items-center gap-2">
                                        <IconActivity size={16} /> Load Current (Amps)
                                    </label>
                                    <input 
                                        type="number" 
                                        value={load}
                                        onChange={(e) => setLoad(e.target.value)}
                                        placeholder="e.g. 32"
                                        className="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-yellow-400 transition-all text-xl"
                                    />
                                </div>

                                {/* Run Length */}
                                <div className="space-y-2">
                                    <label className="text-sm font-semibold text-gray-400 flex items-center gap-2">
                                        <IconRuler size={16} /> Run Length (Metres)
                                    </label>
                                    <input 
                                        type="number" 
                                        value={length}
                                        onChange={(e) => setLength(e.target.value)}
                                        placeholder="e.g. 25"
                                        className="w-full bg-gray-900 border border-gray-700 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-yellow-400 transition-all text-xl"
                                    />
                                </div>

                                {/* Installation Method */}
                                <div className="space-y-2 md:col-span-2">
                                    <label className="text-sm font-semibold text-gray-400 flex items-center gap-2">
                                        <IconThermometer size={16} /> Installation Method
                                    </label>
                                    <div className="grid grid-cols-2 gap-2">
                                        <button
                                            onClick={() => setMethod('clipped')}
                                            className={`p-3 rounded-xl text-sm font-bold transition-all border-2 ${
                                            method === 'clipped' 
                                                ? 'bg-yellow-400 text-gray-900 border-yellow-400' 
                                                : 'bg-gray-700 text-gray-400 border-transparent hover:bg-gray-600'
                                            }`}
                                        >
                                            Clipped Direct
                                            <span className="block text-[10px] font-normal opacity-80">Surface / Cable Tray</span>
                                        </button>
                                        <button
                                            onClick={() => setMethod('insulated')}
                                            className={`p-3 rounded-xl text-sm font-bold transition-all border-2 ${
                                            method === 'insulated' 
                                                ? 'bg-yellow-400 text-gray-900 border-yellow-400' 
                                                : 'bg-gray-700 text-gray-400 border-transparent hover:bg-gray-600'
                                            }`}
                                        >
                                            In Insulation
                                            <span className="block text-[10px] font-normal opacity-80">Stud Walls / Attic</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Results Section */}
                        {results && (
                            <div className={`rounded-3xl p-8 border-2 animate-in fade-in slide-in-from-bottom-4 duration-500 ${
                                results.status === 'success' ? 'bg-green-900/20 border-green-500/50' : 
                                results.status === 'warning' ? 'bg-yellow-900/20 border-yellow-500/50' :
                                'bg-red-900/20 border-red-500/50'
                            }`}>
                                
                                {results.status === 'error' ? (
                                    <div className="text-center text-red-400 font-bold">
                                        <div className="flex justify-center mb-4"><IconAlertTriangle size={48} /></div>
                                        {results.message}
                                    </div>
                                ) : (
                                    <>
                                        <div className="flex items-start justify-between mb-6">
                                            <div>
                                                <h3 className="text-gray-400 text-sm font-bold uppercase tracking-wider mb-1">Recommended Cable Size</h3>
                                                <div className="text-5xl font-black flex items-baseline gap-2">
                                                    {results.size} <span className="text-xl">mm²</span>
                                                </div>
                                                <p className="text-xs text-gray-400 mt-1">
                                                    Max Capacity: <span className="text-white font-bold">{results.rating}A</span> in current method
                                                </p>
                                            </div>
                                            {results.status === 'success' ? (
                                                <div className="text-green-500"><IconCheckCircle size={48} /></div>
                                            ) : results.status === 'warning' ? (
                                                <div className="text-yellow-500"><IconInfo size={48} /></div>
                                            ) : (
                                                <div className="text-red-500"><IconAlertTriangle size={48} /></div>
                                            )}
                                        </div>

                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="bg-black/20 rounded-2xl p-4">
                                                <p className="text-xs text-gray-400 font-bold uppercase">Volt Drop</p>
                                                <p className="text-xl font-bold">{results.drop}V ({results.percent}%)</p>
                                            </div>
                                            <div className="bg-black/20 rounded-2xl p-4">
                                                <p className="text-xs text-gray-400 font-bold uppercase">Status</p>
                                                <p className={`text-lg font-bold leading-tight ${
                                                    results.status === 'success' ? 'text-green-400' : 
                                                    results.status === 'warning' ? 'text-yellow-400' : 'text-red-400'
                                                }`}>
                                                    {results.status === 'success' ? 'Pass' : 
                                                    results.status === 'warning' ? 'Check Usage' : 'Fail'}
                                                </p>
                                            </div>
                                        </div>

                                        <div className="mt-4 p-3 bg-black/20 rounded-xl text-sm text-gray-300 border border-white/10">
                                            {results.message}
                                        </div>
                                        
                                        <button className="mt-6 w-full py-3 bg-white/10 hover:bg-white/20 rounded-xl font-bold flex items-center justify-center gap-2 transition-all">
                                            <IconFileText size={18} /> Save to Job Sheet
                                        </button>
                                    </>
                                )}
                            </div>
                        )}

                        {/* Disclaimer Footer */}
                        <div className="p-4 rounded-2xl bg-gray-800/30 border border-gray-700/50">
                            <p className="text-[10px] text-gray-500 text-center leading-relaxed">
                                <strong>Disclaimer:</strong> This tool is an estimator based on I.S. 10101:2020 standard values for PVC Copper. 
                                It does not account for specific grouping factors (Cg), ambient temperature (Ca), or thermal insulation (Ci) beyond the toggle provided. 
                                Always verify with full design calculations.
                            </p>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
